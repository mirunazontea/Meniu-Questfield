<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meniu Questfield</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

    <style>
        /* --- DESIGN QUESTFIELD --- */
        :root {
            --q-blue: #0E2636;
            --q-gold: #CE9F49;
            --q-green: #E2EFDA;
            --q-white: #FFFFFF;
            --q-bg: #F9F9F9;
            --q-text: #333333;
            --border: #E0E0E0;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--q-bg);
            margin: 0; padding: 0;
            color: var(--q-text);
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 95%; max-width: 1200px;
            background: var(--q-white);
            margin: 40px auto; padding: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            border-radius: 6px;
        }

        /* HEADER */
        header { text-align: center; margin-bottom: 40px; }
        header h1 {
            color: var(--q-blue);
            font-size: 2rem; font-weight: 700;
            text-transform: uppercase; letter-spacing: 2px;
            margin: 0; padding-bottom: 15px; position: relative;
        }
        header h1::after {
            content: ''; display: block; width: 70px; height: 4px;
            background-color: var(--q-gold);
            margin: 15px auto 0; border-radius: 2px;
        }

        /* NAVIGARE DATE */
        .week-nav {
            display: flex; justify-content: center; gap: 15px;
            margin-bottom: 30px; flex-wrap: wrap;
        }
        .week-btn {
            background-color: var(--q-white);
            border: 1px solid var(--border);
            color: var(--q-text); padding: 14px 25px;
            font-family: 'Montserrat', sans-serif; font-weight: 600;
            font-size: 0.9rem; cursor: pointer; transition: all 0.3s ease;
            min-width: 160px; text-align: center; border-radius: 4px;
        }
        .week-btn:hover { border-color: var(--q-gold); transform: translateY(-2px); }
        .week-btn.active {
            background-color: var(--q-blue); color: var(--q-white);
            border-color: var(--q-blue); box-shadow: 0 5px 15px rgba(14, 38, 54, 0.2);
        }

        /* LIMBĂ */
        .lang-wrapper {
            display: flex; justify-content: flex-end; margin-bottom: 10px;
        }
        .lang-btn {
            background: transparent; border: 1px solid #ccc;
            padding: 6px 15px; font-size: 0.75rem; font-weight: 700;
            color: #666; cursor: pointer; border-radius: 4px;
        }
        .lang-btn:hover { border-color: var(--q-blue); color: var(--q-blue); }

        /* TABEL */
        .table-wrap {
            overflow-x: auto; border-top: 3px solid var(--q-blue);
            border-radius: 4px 4px 0 0; min-height: 300px;
        }
        table { width: 100%; border-collapse: collapse; min-width: 800px; }
        th {
            background-color: #F8F8F8; color: var(--q-blue);
            padding: 18px; text-transform: uppercase;
            font-size: 0.85rem; font-weight: 700;
            border: 1px solid var(--border); text-align: center;
        }
        td {
            padding: 15px; border: 1px solid var(--border);
            font-size: 0.9rem; vertical-align: middle;
            text-align: center; line-height: 1.5; color: #444;
        }
        td:first-child {
            background-color: var(--q-blue); color: var(--q-white);
            font-weight: 700; text-align: left; width: 170px;
            border-right: 1px solid #0b1f2d;
        }
        tr.row-salad td:not(:first-child) { background-color: var(--q-green); }

        /* FOOTER & LOCK */
        footer {
            margin-top: auto; padding: 30px; text-align: center;
            font-size: 0.8rem; color: #AAA; width: 100%;
        }
        .admin-lock {
            cursor: pointer; font-size: 16px; opacity: 0.2;
            transition: 0.3s; padding: 10px; color: #333;
        }
        .admin-lock:hover { opacity: 1; color: var(--q-blue); }

        /* LOADING */
        #loadingMsg { 
            display: none; text-align: center; 
            padding: 20px; color: var(--q-blue); font-weight: 600; 
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Meniul Săptămânal</h1>
        </header>

        <div class="week-nav">
            <button onclick="setWeek(0)" id="btnW0" class="week-btn active">Loading...</button>
            <button onclick="setWeek(1)" id="btnW1" class="week-btn">Loading...</button>
            <button onclick="setWeek(2)" id="btnW2" class="week-btn">Loading...</button>
            <button onclick="setWeek(3)" id="btnW3" class="week-btn">Loading...</button>
        </div>

        <div class="lang-wrapper">
            <button onclick="toggleLang()" id="btnLang" class="lang-btn">RO / EN</button>
        </div>

        <div id="loadingMsg"><i class="fas fa-spinner fa-spin"></i> Se încarcă meniul...</div>

        <div class="table-wrap">
            <table id="menuTable">
                <thead><tr id="tableHeader"></tr></thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>

    <footer>
        <i class="fas fa-lock admin-lock" onclick="goToGoogleSheet()" title="Editare Meniu"></i>
        <div style="margin-top:10px;">&copy; 2024 Questfield</div>
    </footer>

    <script>
        // =========================================================================
        // 1. CONFIGURARE LINK-URI (AICI PUI LINK-URILE TALE)
        // =========================================================================
        
        // Înlocuiește link-urile goale "" cu link-urile tale PUBLICE CSV
        // Exemplu: "https://docs.google.com/spreadsheets/d/.../pub?gid=...&output=csv"
        
        const googleSheetLinks = {
            "S1": "", 
            "S2": "",
            "S3": "",
            "S4": "" 
        };

        // Pune aici link-ul tău de EDITARE (cel pe care mi l-ai trimis tu)
        // Când dai click pe lăcățel, te va duce direct la editare.
        const editLink = "https://docs.google.com/spreadsheets/d/1RpPfd-5vti-R4TBKCusr1gok-O7eTSdC42be_YlwSkA/edit"; 

        // =========================================================================
        // 2. DATE DE REZERVĂ (HARDCODATE)
        // Dacă nu pui link-urile CSV, site-ul va afișa aceste date
        // =========================================================================
        let menuData = {
          "S1": {
            "ro": {
              "days": [
                "Luni",
                "Marti",
                "Miercuri",
                "Joi",
                "Vineri"
              ],
              "rows": [
                {
                  "type": "Felul 1",
                  "items": [
                    "Supă cremă de legume cu pătrunjel proaspăt și crutoane asezonate",
                    "Supă de curcan cu găluște",
                    "Ciorbă de văcuță",
                    "Supă cremă de linte și crutoane asezonate",
                    "Ciorbă țărănească de pui cu legume și ou"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "Supă cremă de legume cu pătrunjel proaspăt și crutoane asezonate",
                    "Supă de legume cu găluște",
                    "Supă cremă de rădăcinoase",
                    "Supă cremă de linte și crutoane asezonate",
                    "Ciorbă țărănească de legume"
                  ]
                },
                {
                  "type": "Felul 2",
                  "items": [
                    "File de somon la cuptor cu risotto",
                    "Friptură de curcan feliată la cuptor cu legume la cuptor (cartofi baby, ardei, dovlecei și zucchini)",
                    "Vază călită cu carne și mămăligă",
                    "Quesadilla cu carne de vită",
                    "Chiken Fingers cu piure de cartofi"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "File de somon la cuptor cu risotto / Wrap cu pateu de linte și ardei copți",
                    "Mâncare de spanac cu ouă",
                    "Mămăligă cu brânză, smântână și ou poșat",
                    "Quesadilla vegetariană",
                    "Paste Napoletana (cu mozzarella)"
                  ]
                },
                {
                  "type": "Salată",
                  "items": [
                    "Salată de roșii și castraveți cu ceapă verde",
                    "Salată grecească",
                    "-",
                    "Rondele de legume",
                    "Salată de varză cu morcovi"
                  ]
                },
                {
                  "type": "Gustare",
                  "items": [
                    "Mini guguluf imperial",
                    "Sandviș cu unt, șuncă, cașcaval și ardei",
                    "Chec cu lămâie",
                    "Carrot Cake",
                    "Plăcintă cu brânză dulce"
                  ]
                }
              ]
            },
            "en": {
              "days": [
                "Monday",
                "Tuesday",
                "Wednesday",
                "Thursday",
                "Friday"
              ],
              "rows": [
                {
                  "type": "Main Course",
                  "items": [
                    "Cream Vegetable Soup with Fresh Parsley and Seasoned Croutons",
                    "Turkey Broth with Fluffy Dumplings",
                    "Beef Soup",
                    "Creamy Lentil Soup with Vegetables and Croutons",
                    "Rustic Farmhouse Chicken Soup with Garden Vegetables and Egg Drop"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "Cream Vegetable Soup with Fresh Parsley and Seasoned Croutons",
                    "Vegetable Soup with Fluffy Dumplings",
                    "Creamy Root Vegetable Soup",
                    "Creamy Lentil Soup with Vegetables and Croutons",
                    "Rustic Soup with Garden Vegetables and Egg Drop"
                  ]
                },
                {
                  "type": "Second Course",
                  "items": [
                    "Oven-Baked Salmon Fillet with Risotto",
                    "Oven-Roasted Turkey Slices with Baked Baby Potatoes, Peppers, and Courgettes",
                    "Sautéed cabbage with meat and polenta",
                    "Beef Quesadilla",
                    "Chiken Fingers with Mashed Potatoes"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "Oven-baked salmon fillet with risotto / Lentil pâté and roasted pepper wrap",
                    "Spinach and Fried Eggs",
                    "Polenta with cheese, sour cream and a poached egg",
                    "Vegetarian Quesadilla",
                    "Napoletana pasta (with mozzarella)"
                  ]
                },
                {
                  "type": "Salad",
                  "items": [
                    "Tomato and Cucumber Salad with Spring Onion",
                    "Greek Salad",
                    "-",
                    "Vegetable Rings",
                    "Cabbage and Carrot Salad"
                  ]
                },
                {
                  "type": "Snack",
                  "items": [
                    "Mini Royal Bundt Cake",
                    "Buttered Ham and Cheese Sandwich with Peppers",
                    "Chec cu lămâie",
                    "Carrot Cake",
                    "Sweet Cheese Pie"
                  ]
                }
              ]
            }
          },
          "S2": {
            "ro": {
              "days": [
                "Luni",
                "Marti",
                "Miercuri",
                "Joi",
                "Vineri"
              ],
              "rows": [
                {
                  "type": "Felul 1",
                  "items": [
                    "Supă cremă de rădăcinoase și pită asezonată",
                    "Supă de pui cu fidea alfabet",
                    "Borș de curcan",
                    "Supă cremă de morcovi și cartofi dulci, crutoane asezonate",
                    "Ciorbă de perișoare cu carne de vită"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "Supă cremă de rădăcinoase și pită asezonată",
                    "Supă de legume cu fidea alfabet",
                    "Școală: Borș de legume",
                    "Supă cremă de morcovi și cartofi dulci, crutoane asezonate",
                    "Ciorbă de legume"
                  ]
                },
                {
                  "type": "Felul 2",
                  "items": [
                    "Piept de curcan la cuptor cu sos alb și risotto",
                    "Aripioare de pui marinate și cartofi cu usturoi și rozmarin",
                    "Școală:  Ardei umpluți cu vită și orez, serviți cu iaurt grecesc\nGrădi: Chifteluțe de vită cu piure de cartofi",
                    "Pulpe de pui la cuptor și mix de legume sote (fasole verde și morcovi baby)",
                    "Penne cu 4 tipuri de brânză și broccoli (sau cu sos roșu)"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "Frigărui cu halloumi și legume + risotto",
                    "Cașcaval pane și cartofi cu ustoroi și rozmarin",
                    "Ardei umpluți cu orez  și legume, serviți cu iaurt grecesc",
                    "Tocăniță de legume cu linte",
                    "Penne cu 4 tipuri de brânză și broccoli (sau cu sos roșu)"
                  ]
                },
                {
                  "type": "Salată",
                  "items": [
                    "Salată mix de frunze cu roșii cherry și castraveți",
                    "Salată de varză",
                    "Rondele de legume",
                    "Salată de sfeclă roșie",
                    "Broccoli"
                  ]
                },
                {
                  "type": "Gustare",
                  "items": [
                    "Sandviș cu unt, șuncă, cașcaval și ardei",
                    "Ștrudel cu mere",
                    "Prăjitură cu vișine",
                    "Chec cu lămâie",
                    "Lipie cu humus și ardei"
                  ]
                }
              ]
            },
            "en": {
              "days": [
                "Monday",
                "Tuesday",
                "Wednesday",
                "Thursday",
                "Friday"
              ],
              "rows": [
                {
                  "type": "Main Course",
                  "items": [
                    "Creamy Root Vegetable Soup with Seasoned Flatbread",
                    "Chicken Soup with Alphabet Noodles",
                    "Turkey Borsch",
                    "Creamy Carrot and Sweet Potato Soup with Seasoned Croutons",
                    "Beef Meatball Soup"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "Creamy Root Vegetable Soup with Seasoned Flatbread",
                    "Vegetable Soup with Alphabet Noodles",
                    "Vegetable borscht",
                    "Creamy Carrot and Sweet Potato Soup with Seasoned Croutons",
                    "Vegetable soup"
                  ]
                },
                {
                  "type": "Second Course",
                  "items": [
                    "Oven-Roasted Turkey Breast with White Sauce and Risotto",
                    "Marinated Grilled Chicken Breast with Courgettes",
                    "School: Stuffed peppers with beef and rice, served with Greek yogurt\nKindergarten: Beef meatballs with mashed potatoes",
                    "Oven-Roasted Chicken Thighs with Sautéed Vegetable Mix (green beans and baby carrots)",
                    "Four-Cheese / Tomato Sauce Penne with Broccoli"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "Halloumi and Vegetable Skewers with Risotto",
                    "Breaded Cheese with garlic-rosemary baked potatoes",
                    "Stuffed peppers with rice and vegetables, served with Greek yoghurt",
                    "Vegetable and Lentil Stew",
                    "Four-Cheese / Tomato Sauce Penne with Broccoli"
                  ]
                },
                {
                  "type": "Salad",
                  "items": [
                    "Mixed Leaf Salad with Cherry Tomatoes and Cucumbers",
                    "Coleslaw",
                    "Vegetable slices",
                    "Beetroot salad",
                    "Broccoli"
                  ]
                },
                {
                  "type": "Snack",
                  "items": [
                    "Buttered Ham and Cheese Sandwich with Peppers",
                    "Apple Strudel",
                    "Sour Cherry Sponge Cake",
                    "Lemon Loaf Cake",
                    "Flatbread with hummus and peppers"
                  ]
                }
              ]
            }
          },
          "S3": {
            "ro": {
              "days": [
                "Luni",
                "Marti",
                "Miercuri",
                "Joi",
                "Vineri"
              ],
              "rows": [
                {
                  "type": "Felul 1",
                  "items": [
                    "Supă cremă de roșii cu busuioc proaspăt și crutoane asezonate",
                    "Supă de pui cu găluște",
                    "Supă cremă de morcovi cu năut și crutoane asezonate",
                    "Ciorbă țărănească de curcan cu legume și ou",
                    "Ciorbă de pui oltenească cu cartofi și dovlecei (fără mărar)"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "Supă cremă de roșii cu busuioc proaspăt și crutoane asezonate",
                    "Supă de legume cu găluște",
                    "Supă cremă de morcovi cu năut și crutoane asezonate",
                    "Borș țărănesc de legume cu zdrențe de ou",
                    "Supă cremă de legume"
                  ]
                },
                {
                  "type": "Felul 2",
                  "items": [
                    "Specialitate grecească",
                    "Piept de pui soté cu usturoi și parmezan, wedges de cartofi albi, cartofi dulci și morcovi gratinați",
                    "Friptură de vită (felii mici, înăbușită bine) cu sos separat și risotto",
                    "Școală: Mâncare de mazăre cu carne de curcan / \nGrădiniță: Mâncare de cartofi cu carne de curcan",
                    "Pui crispy cu piure de legume"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "Specialitate grecească vegetariană",
                    "Couscous cu legume gratinate",
                    "Gratin de brocoli, morcovi, smântână și parmezan",
                    "Mâncare de mazăre",
                    "Cașcaval la cuptor cu piure de legume"
                  ]
                },
                {
                  "type": "Salată",
                  "items": [
                    "Mix de frunze cu roșii cherry și castraveți",
                    "Salată grecească",
                    "Salată de varză cu morcovi",
                    "Salată de sfeclă roșie",
                    "Salată asortată cu frunze verzi"
                  ]
                },
                {
                  "type": "Gustare",
                  "items": [
                    "Mini-guguluf imperial",
                    "Placintă cu branză sărată",
                    "Prajitură cu mascarpone și căpșuni",
                    "Carrot cake",
                    "Iaurt cu banană"
                  ]
                }
              ]
            },
            "en": {
              "days": [
                "Monday",
                "Tuesday",
                "Wednesday",
                "Thursday",
                "Friday"
              ],
              "rows": [
                {
                  "type": "Main Course",
                  "items": [
                    "Creamy Tomato Soup with Fresh Basil and Seasoned Croutons",
                    "Chicken Soup with Fluffy Dumplings",
                    "Cream of carrot soup with chickpeas and seasoned croutons",
                    "Rustic Country-Style Turkey Soup with Vegetables and Egg Drop",
                    "Oltenian-Style Chicken Soup with Potatoes and Courgettes (No Dill)"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "Creamy Tomato Soup with Fresh Basil and Seasoned Croutons",
                    "Vegetable Soup with Fluffy Dumplings",
                    "Cream of carrot soup with chickpeas and seasoned croutons",
                    "Traditional Country-Style Vegetable Borsch with Egg Drop",
                    "Cream of vegetable soup"
                  ]
                },
                {
                  "type": "Second Course",
                  "items": [
                    "Greek Special",
                    "Sautéed Chicken Breast with Garlic and Parmesan, White Potato Wedges, Sweet Potatoes, and Gratinated Carrots",
                    "Braised Beef (small, well-tenderised slices) with Sauce on the Side and Risotto",
                    "School: Stewed peas with turkey\nKindergarten: Stewed potatoes with turkey",
                    "Crispy Chicken with Vegetable Purée"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "Vegetarian Greek Special",
                    "Couscous with Grilled Vegetables",
                    "Broccoli and carrot gratin with cream and Parmesan",
                    "Polenta with Cheese, Sour Cream, and Fried Egg",
                    "Oven-Baked Cheese with Vegetable Purée"
                  ]
                },
                {
                  "type": "Salad",
                  "items": [
                    "Mixed Leaf Salad with Cherry Tomatoes and Cucumber",
                    "Greek Salad",
                    "Cabbage and carrot salad",
                    "Beetroot salad",
                    "Mixed Salad"
                  ]
                },
                {
                  "type": "Snack",
                  "items": [
                    "Imperial Mini Bundt Cake",
                    "Savoury cheese pie",
                    "Mascarpone and Strawberry Cake",
                    "Carrot Cake",
                    "Banana Yoghurt"
                  ]
                }
              ]
            }
          },
          "S4": {
            "ro": {
              "days": [
                "Luni",
                "Marti",
                "Miercuri",
                "Joi",
                "Vineri"
              ],
              "rows": [
                {
                  "type": "Felul 1",
                  "items": [
                    "Supă cremă de rădăcinoase și pită asezonată",
                    "Supă de pui cu fidea alfabet",
                    "Borș țărănesc de legume cu ou, smântână și leuștean",
                    "Supă de vită cu legume julienne",
                    "Ciorbă cu perișoare din carne de curcan"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "Supă cremă de rădăcinoase și pită asezonată",
                    "Ciorbă oltenească de legume",
                    "Borș țărănesc de legume cu ou, smântână și leuștean",
                    "Ciorbă de legume cu zdrențe de ou",
                    "Supă cremă de linte"
                  ]
                },
                {
                  "type": "Felul 2",
                  "items": [
                    "Biban cu cartofi natur și sos de lămaie",
                    "Piept de pui marinat și salată de paste cu legume în stil mediteranean",
                    "Ostropel de curcan cu mămăligă",
                    "Specialitate italiană",
                    "Cașcaval pane la cuptor cu legume la cuptor"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "Biban cu cartofi natur și sos de lămaie / Paste cu sos de roșii și parmezan",
                    "Halloumi la grătar și salată de paste cu legume în stil mediteranean",
                    "Tocănită de legume cu năut",
                    "Specialitate italiană",
                    "Cașcaval pane la cuptor cu legume la cuptor"
                  ]
                },
                {
                  "type": "Salată",
                  "items": [
                    "Salată verde",
                    "-",
                    "Salată de varză albă și roșie",
                    "Mix de legume colorate",
                    "Salată de crudități"
                  ]
                },
                {
                  "type": "Gustare",
                  "items": [
                    "Focaccia cu cremă de brânză și legume",
                    "Banana Bread",
                    "Clătite cu miere",
                    "Orez cu lapte",
                    "Prăjitură cu vișine"
                  ]
                }
              ]
            },
            "en": {
              "days": [
                "Monday",
                "Tuesday",
                "Wednesday",
                "Thursday",
                "Friday"
              ],
              "rows": [
                {
                  "type": "Main Course",
                  "items": [
                    "Creamy Root Vegetable Soup with Seasoned Flatbread",
                    "Chicken Soup with Alphabet Noodles",
                    "Rustic vegetable borscht with egg, sour cream, and lovage",
                    "Beef soup with julienned vegetables",
                    "Turkey Meatball Soup"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "Creamy Root Vegetable Soup with Seasoned Flatbread",
                    "Oltenian vegetable soup",
                    "Rustic vegetable borscht with egg, sour cream and lovage",
                    "Vegetable soup with egg ribbons",
                    "Cream of lentil soup"
                  ]
                },
                {
                  "type": "Second Course",
                  "items": [
                    "Seabass with boiled potatoes and lemon sauce",
                    "Marinated chicken breast with pasta salad and vegetables in Mediterranean style",
                    "Turkey stew in garlic-tomato sauce, served with polenta",
                    "Italian Special",
                    "Oven-Baked Breaded Cheese with Roasted Vegetables"
                  ]
                },
                {
                  "type": "Vegetarian",
                  "items": [
                    "Seabass with boiled potatoes and lemon sauce / Pasta with tomato sauce and Parmesan",
                    "Grilled halloumi with pasta salad and vegetables in Mediterranean style",
                    "Vegetable stew with chickpeas",
                    "Italian Special",
                    "Oven-Baked Breaded Cheese with Roasted Vegetables"
                  ]
                },
                {
                  "type": "Salad",
                  "items": [
                    "Green Salad",
                    "-",
                    "White and red cabbage salad",
                    "Rainbow Salad",
                    "Raw vegetable salad"
                  ]
                },
                {
                  "type": "Snack",
                  "items": [
                    "Focaccia with cream cheese and vegetables",
                    "Banana Bread",
                    "Fluffy Pancakes with Honey",
                    "Rice pudding",
                    "Sour Cherry Cake"
                  ]
                }
              ]
            }
          }
        };

        // =========================================================================
        // 3. LOGICA APLICAȚIEI
        // =========================================================================
        let currentLang = 'ro';
        let activeIdx = 0; 

        // FETCH GOOGLE SHEETS
        function fetchSheets() {
            // Dacă nu avem link-uri configurate, nu facem nimic (rămâne pe datele locale)
            if(!googleSheetLinks["S1"]) return;

            document.getElementById('loadingMsg').style.display = 'block';
            document.getElementById('menuTable').style.opacity = '0.3';

            let promises = [];
            ['S1', 'S2', 'S3', 'S4'].forEach(key => {
                if(googleSheetLinks[key]) {
                    promises.push(new Promise(resolve => {
                        Papa.parse(googleSheetLinks[key], {
                            download: true,
                            complete: function(results) {
                                let parsed = parseData(results.data);
                                if(parsed) menuData[key] = parsed;
                                resolve();
                            },
                            error: resolve
                        });
                    }));
                }
            });

            Promise.all(promises).then(() => {
                document.getElementById('loadingMsg').style.display = 'none';
                document.getElementById('menuTable').style.opacity = '1';
                renderMenu();
            });
        }

        function parseData(rows) {
            let roIdx = -1, enIdx = -1;
            // Găsim rândul de start (caută "Luni" și "Monday")
            for(let i=0; i<rows.length; i++) {
                let str = JSON.stringify(rows[i]).toLowerCase();
                if(str.includes("luni")) roIdx = i;
                if(str.includes("monday")) enIdx = i;
            }
            if(roIdx === -1 || enIdx === -1) return null;

            return {
                ro: extract(rows, roIdx),
                en: extract(rows, enIdx)
            };
        }

        function extract(rows, start) {
            let header = rows[start];
            // PapaParse returnează array. Zilele sunt de obicei index 1-5
            // But sometimes the CSV has empty first col. Let's find index of "Luni"/"Monday"
            let dayStartIdx = -1;
            for(let k=0; k<header.length; k++) {
                if(header[k].toLowerCase().includes("luni") || header[k].toLowerCase().includes("monday")) {
                    dayStartIdx = k;
                    break;
                }
            }
            if(dayStartIdx == -1) dayStartIdx = 1; // Fallback

            let days = header.slice(dayStartIdx, dayStartIdx+5).filter(d => d);
            let dataRows = [];
            let i = start + 1;
            while(i < rows.length && dataRows.length < 6) {
                let r = rows[i];
                // Category usually at dayStartIdx - 1
                let catIdx = dayStartIdx > 0 ? dayStartIdx - 1 : 0;
                
                if(r && r[catIdx]) {
                    dataRows.push({ type: r[catIdx], items: r.slice(dayStartIdx, dayStartIdx+5) });
                }
                i++;
            }
            return { days: days, rows: dataRows };
        }

        // DATE CALENDARISTICE
        function getMonday(d) {
            d = new Date(d);
            var day = d.getDay(), diff = d.getDate() - day + (day == 0 ? -6 : 1);
            return new Date(d.setDate(diff));
        }
        function formatDate(d) {
            let dd = d.getDate().toString().padStart(2,'0');
            let mm = (d.getMonth()+1).toString().padStart(2,'0');
            return `${dd}.${mm}`;
        }
        function updateButtons() {
            let today = new Date();
            let start = getMonday(today);
            for(let i=0; i<4; i++) {
                let s = new Date(start); s.setDate(start.getDate() + i*7);
                let e = new Date(s); e.setDate(s.getDate() + 4);
                let btn = document.getElementById(`btnW${i}`);
                if(btn) btn.textContent = `${formatDate(s)} - ${formatDate(e)}`;
            }
        }

        // RENDER
        function renderMenu() {
            let key = `S${activeIdx+1}`;
            let data = menuData[key] ? menuData[key][currentLang] : null;
            let thead = document.getElementById('tableHeader');
            let tbody = document.getElementById('tableBody');

            if(!data) {
                tbody.innerHTML = `<tr><td colspan="6" style="padding:20px;text-align:center">Lipsă date.</td></tr>`;
                return;
            }

            thead.innerHTML = `<th>${currentLang==='ro'?'Categorie':'Course'}</th>`;
            data.days.forEach(d => {
                let th = document.createElement('th'); th.textContent = d; thead.appendChild(th);
            });

            tbody.innerHTML = '';
            data.rows.forEach(r => {
                let tr = document.createElement('tr');
                if(r.type.toLowerCase().includes('salat') || r.type.toLowerCase().includes('salad')) tr.classList.add('row-salad');
                
                let td = document.createElement('td'); td.innerHTML = r.type; tr.appendChild(td);
                r.items.forEach(it => {
                    let cell = document.createElement('td'); cell.textContent = it || '-'; tr.appendChild(cell);
                });
                tbody.appendChild(tr);
            });

            document.querySelectorAll('.week-btn').forEach((b,i) => {
                if(i===activeIdx) b.classList.add('active'); else b.classList.remove('active');
            });
        }

        function setWeek(i) { activeIdx = i; renderMenu(); }
        function toggleLang() {
            currentLang = currentLang==='ro'?'en':'ro';
            document.getElementById('btnLang').textContent = currentLang==='ro'?'RO / EN':'EN / RO';
            renderMenu();
        }

        // LĂCĂȚEL -> GOOGLE DRIVE EDIT
        function goToGoogleSheet() {
            let p = prompt("Parola:");
            if(p === "questfield") {
                window.open(editLink, '_blank');
            } else if(p) alert("Parolă greșită");
        }

        // INIT
        window.onload = function() {
            updateButtons();
            fetchSheets(); // Încearcă să ia datele live
            renderMenu();  // Afișează datele (local sau live)
        };
    </script>
</body>
</html>
